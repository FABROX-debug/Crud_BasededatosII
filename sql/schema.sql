CREATE TABLE USUARIOS (
    ID_USUARIO       NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    DNI              VARCHAR2(8) NOT NULL,
    NOMBRE           VARCHAR2(100) NOT NULL,
    TIPO             VARCHAR2(20) CHECK (TIPO IN ('ADMIN','MEDICO','PACIENTE')),
    PASSWORD         VARCHAR2(200) NOT NULL,
    ESTADO           CHAR(1) DEFAULT 'S' CHECK (ESTADO IN ('S','N'))
);

CREATE TABLE PACIENTES (
    ID_PACIENTE NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    DNI         VARCHAR2(8) UNIQUE NOT NULL,
    NOMBRE      VARCHAR2(100) NOT NULL,
    CORREO      VARCHAR2(120),
    TELEFONO    VARCHAR2(15),
    FECHA_REG   DATE DEFAULT SYSDATE
);

CREATE TABLE MEDICOS (
    ID_MEDICO    NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    DNI          VARCHAR2(8) UNIQUE NOT NULL,
    NOMBRE       VARCHAR2(100) NOT NULL,
    ESPECIALIDAD VARCHAR2(60) NOT NULL,
    ESTADO       CHAR(1) DEFAULT 'S' CHECK (ESTADO IN ('S','N'))
);

CREATE TABLE HORARIOS (
    ID_HORARIO     NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ID_MEDICO      NUMBER NOT NULL,
    FECHA          DATE NOT NULL,
    HORA_INICIO    VARCHAR2(5) NOT NULL,
    HORA_FIN       VARCHAR2(5) NOT NULL,
    DISPONIBLE     CHAR(1) DEFAULT 'S' CHECK (DISPONIBLE IN ('S','N')),
    CONSTRAINT FK_HORARIO_MEDICO FOREIGN KEY (ID_MEDICO)
        REFERENCES MEDICOS(ID_MEDICO)
);

CREATE TABLE CITAS (
    ID_CITA     NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ID_PACIENTE NUMBER NOT NULL,
    ID_MEDICO   NUMBER NOT NULL,
    ID_HORARIO  NUMBER NOT NULL,
    MOTIVO      VARCHAR2(300),
    FECHA_REG   DATE DEFAULT SYSDATE,
    CONSTRAINT FK_CITA_PAC FOREIGN KEY (ID_PACIENTE)
        REFERENCES PACIENTES(ID_PACIENTE),
    CONSTRAINT FK_CITA_MED FOREIGN KEY (ID_MEDICO)
        REFERENCES MEDICOS(ID_MEDICO),
    CONSTRAINT FK_CITA_HOR FOREIGN KEY (ID_HORARIO)
        REFERENCES HORARIOS(ID_HORARIO)
);


CREATE TABLE AUDITORIA (
    ID_AUDITORIA NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    TABLA        VARCHAR2(30),
    OPERACION    VARCHAR2(10),
    USUARIOBD    VARCHAR2(30),
    FECHA_HORA   DATE DEFAULT SYSDATE
);


